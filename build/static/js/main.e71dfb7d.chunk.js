(this["webpackJsonpimage-upload"]=this["webpackJsonpimage-upload"]||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c=n(1),i=n.n(c),r=n(3),a=n.n(r),o=(n(13),n(2));n(14);function s(){document.body.classList.toggle("noscroll")}var l=n(0);function u(e){var t,n=e.children,i=e.onClose;Object(c.useEffect)((function(){if(!t)return s(),function(){return s()}}),[t]);var r=Object(c.useCallback)((function(e){"Escape"===e.key&&i()}),[i]);return Object(c.useEffect)((function(){return document.addEventListener("keydown",r),function(){document.removeEventListener("keydown",r)}}),[r]),a.a.createPortal(Object(l.jsx)("div",{onClick:i,className:"modal",children:Object(l.jsxs)("article",{onClick:function(e){return e.stopPropagation()},children:[Object(l.jsx)("header",{children:Object(l.jsx)("button",{onClick:i,children:"close"})}),Object(l.jsx)("section",{children:n})]})}),document.getElementById("root"))}var j=n(6),d=n.n(j),b=(n(16),i.a.createContext(null)),h=function(e){var t=e.children,n=Object(c.useState)(""),i=Object(o.a)(n,2),r=i[0],a=i[1],s=Object(c.useState)(""),u=Object(o.a)(s,2),j=u[0],d=u[1],h=Object(c.useState)(""),O=Object(o.a)(h,2),f={imagePreview:[r,a],imageToCrop:[O[0],O[1]],base64Preview:[j,d]};return Object(l.jsx)(b.Provider,{value:f,children:t})};function O(e){var t,n,r=e.onClose,a=i.a.useContext(b),s=Object(o.a)(a.imagePreview,2),u=(s[0],s[1]),j=Object(o.a)(a.imageToCrop,2),h=j[0],O=j[1],f=Object(o.a)(a.base64Preview,2),g=(f[0],f[1]),v=Object(c.useRef)(null),m=Object(c.useRef)(null),x=Object(c.useState)({unit:"%",width:50,height:50,x:25,y:25}),p=Object(o.a)(x,2),C=p[0],w=p[1],k=Object(c.useState)(null),y=Object(o.a)(k,2),L=y[0],P=y[1];Object(c.useEffect)((function(){if(L&&m.current&&v.current){var e=v.current,t=m.current,n=L,c=e.naturalWidth/e.width,i=e.naturalHeight/e.height,r=t.getContext("2d"),a=window.devicePixelRatio;t.width=n.width*a,t.height=n.height*a,r.setTransform(a,0,0,a,0,0),r.imageSmoothingQuality="high",r.drawImage(e,n.x*c,n.y*i,n.width*c,n.height*i,0,0,n.width,n.height)}}),[L]);var I=Object(c.useCallback)((function(e){v.current=e}),[]);return Object(l.jsxs)("div",{className:"CropImage",children:[h||C?Object(l.jsx)(d.a,{src:h,onImageLoaded:I,crop:C,onChange:function(e){w(e)},onComplete:function(e){P(e)},style:{width:"300px",height:"auto"},ruleOfThirds:!0}):null,Object(l.jsxs)("div",{children:[Object(l.jsx)("canvas",{ref:m,style:{display:"none",width:Math.round(null!==(t=null===L||void 0===L?void 0:L.width)&&void 0!==t?t:0),height:Math.round(null!==(n=null===L||void 0===L?void 0:L.height)&&void 0!==n?n:0)}}),Object(l.jsx)("button",{type:"button",disabled:!(null===L||void 0===L?void 0:L.width)||!(null===L||void 0===L?void 0:L.height),onClick:function(){return function(e,t){t&&e&&(e.toBlob((function(e){var t=URL.createObjectURL(e);u(t),g(e)}),"image/png",1),O(""),r())}(m.current,L)},children:"Select this image"})]})]})}n(17);function f(e){var t=i.a.useContext(b),n=Object(o.a)(t.imageToCrop,2),c=n[0],r=n[1],a=e.onClose,s=e.label;return Object(l.jsx)(u,{titleLabel:s,onClose:a,children:c?Object(l.jsx)(O,{onClose:a}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("label",{htmlFor:"picture",children:"Take a photo"}),Object(l.jsx)("input",{type:"file",id:"picture",name:"picture",required:!0,accept:"image/*",onChange:function(e){if(null!==e.target.files){var t=e.target.files[0],n=URL.createObjectURL(t);r(n)}}})]})})}var g=n(4);function v(e){var t=e.onClose,n=i.a.useContext(b),r=Object(o.a)(n.imageToCrop,2),a=r[0],s=r[1],j=Object(c.useRef)(null),d=Object(c.useRef)(null);Object(c.useEffect)((function(){g.isMobile||h()}),[j]);var h=function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({video:{width:300},audio:!1}).then((function(e){var t=j.current;t&&(t.srcObject=e,t.play())})).catch((function(e){console.log("error",e)}))},f=function(){var e=j.current;e.srcObject.getTracks().forEach((function(e){e.stop()})),e.srcObject=null};return Object(l.jsx)(u,{onClose:t,children:a?Object(l.jsx)(O,{onClose:t}):Object(l.jsxs)("div",{className:"OpenWebcam",children:[Object(l.jsx)("video",{onPlay:function(){return function(){var e=j.current,t=d.current,n=t.getContext("2d");return t.width=320,t.height=240,setInterval((function(){n.drawImage(e,0,0,320,240)}),200)}()},ref:j}),Object(l.jsx)("button",{type:"button",onClick:function(){return function(){var e=d.current.toDataURL("image/jpeg");s(e),f()}()},children:"Take a photo"}),Object(l.jsx)("canvas",{ref:d,style:{display:"none"}})]})})}var m=n(7),x=n(8),p=(n(19),["modal","label"]);function C(e){var t=e.modal,n=e.label,i=Object(x.a)(e,p),r=Object(c.useState)(!1),a=Object(o.a)(r,2),s=a[0],u=a[1];return Object(l.jsxs)("span",{className:"openModal",children:[Object(l.jsx)("button",{onClick:function(){return u(!0)},children:n}),s&&Object(l.jsx)(t,Object(m.a)({onClose:function(){return u(!1)}},i))]})}n(20);var w=function(){return Object(l.jsxs)("svg",{width:"90",height:"100",viewBox:"0 0 90 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(l.jsx)("path",{d:"M0 4C0 1.79086 1.79086 0 4 0H86C88.2091 0 90 1.79086 90 4V96C90 98.2091 88.2091 100 86 100H4C1.79086 100 0 98.2091 0 96V4Z",fill:"#F4F4F4"}),Object(l.jsx)("path",{d:"M61 68C59.4348 60.0541 52.8261 54 45 54C37.1739 54 30.7391 60.0541 29 68",stroke:"#999999",strokeWidth:"2",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Object(l.jsx)("path",{d:"M45 48C49.4183 48 53 44.4183 53 40C53 35.5817 49.4183 32 45 32C40.5817 32 37 35.5817 37 40C37 44.4183 40.5817 48 45 48Z",stroke:"#999999",strokeWidth:"2",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})]})};function k(e){var t=e.imagePreview;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("p",{children:"Image preview"}),t?Object(l.jsx)("img",{src:t,alt:"alt",width:"90",height:"auto"}):Object(l.jsx)(w,{})]})}function y(){var e=i.a.useContext(b),t=Object(o.a)(e.imagePreview,2),n=t[0],r=(t[1],Object(o.a)(e.base64Preview,2)),a=r[0],s=(r[1],Object(c.useState)("")),u=Object(o.a)(s,2),j=u[0],d=u[1],h=Object(c.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){return d(t.result.slice(0,50)),t.result}}));return Object(c.useEffect)((function(){a&&h(a)}),[h,a]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("header",{children:Object(l.jsx)("h1",{children:"Testing Image Upload"})}),Object(l.jsxs)("main",{children:[Object(l.jsxs)("div",{className:"imagePreview",children:[Object(l.jsx)(k,{imagePreview:n}),Object(l.jsxs)("p",{children:["Image URL: ",n||"none"]}),Object(l.jsxs)("p",{children:["Base64: ",j?j+" [...]":"none"]})]}),Object(l.jsxs)("div",{className:"userSelection",children:[Object(l.jsx)(C,{modal:f,label:"Image Upload"}),!g.isMobile&&Object(l.jsx)(C,{modal:v,label:"Image Webcam"})]})]})]})}var L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,22)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),r(e),a(e)}))};a.a.render(Object(l.jsx)(i.a.StrictMode,{children:Object(l.jsx)(h,{children:Object(l.jsx)(y,{})})}),document.getElementById("root")),L()}],[[21,1,2]]]);
//# sourceMappingURL=main.e71dfb7d.chunk.js.map